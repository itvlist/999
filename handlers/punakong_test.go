package handlers

import (
	"github.com/sirupsen/logrus"
	"regexp"
	"testing"
)

var key=`
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="referrer" content="never">
    <title>网盘播放器v201812 parse.hcc11.com</title>
    <script src="//cdn.staticfile.org/jquery/2.0.3/jquery.min.js"></script>
    <link href="/Content/index.css?v=1.3" rel="stylesheet" />
    <script src="/Scripts/parse.js"></script>
</head>
<body>

    <div id="div_player">
        <div style="text-align: center">
            <img src="//ww2.sinaimg.cn/large/0060lm7Tly1fp5smu5hjxg30m80dcwxz.gif" style="width: 300px; height: 250px;" />
        </div>
    </div>
        <script src="//cdn.staticfile.org/hls.js/0.10.1/hls.min.js"></script>
        <link href="//cdn.staticfile.org/dplayer/1.25.0/DPlayer.min.css" rel="stylesheet">
        <script src="//cdn.staticfile.org/dplayer/1.25.0/DPlayer.min.js"></script>

    <script type="text/javascript">
        var url = '233535F4D3E6F69637275667D25627574716E6769637D23737F6D287624433528325776423523685A744A76695A466652616E464235287144546E46784A7D636965665A4B4C47476A44563378715A5D35627574716E6769637D23737F6D2876223638343034303436313D337562796078756D23737F6D28762153393436423E614D6535437941445C4D34696D29756B6D2373756363616D23737F6D287626303336333632356730326361643139303261643931636432356534336562666D357624307D6E213035413033563835323526314532352935453235223935323525383532352935453235243245323529324532352535453235254245323529393532352735453235273235273235283D264459333034363135544335214235256D616E656C6966603235224335247E656D6863616474716D3E6F696479637F607379646D247E65647E6F636D25637E6F6073756276246661383166616034383939353831616933633435366633383539323661633665353664313831363D366622373631323431393D32746629323A626D39646F3333603431613931333433346531626260303934313839356369363233313460313033646165303636423525313436616666693035336839363832693663343638373232303239326932366130336461653036364235223938313831343642352370716B474553794F2D6F636E20736364657F6C63696C616E216471646E276E696A6965626D2E636E29323A626F2F2A33707474786', err = '',dmId=0,vt='6';
    </script>
    

    <script src="/ParsePlayer/Player/Js?time=1640397663&amp;key=86f125cdbc0583af1d99e257db0e03fc" type="text/javascript"></script>
</body>
</html>%  
`

func TestRegex(t *testing.T) {
	reg1 := regexp.MustCompile(`var url = '[^']+'`)

	result := reg1.FindString(key)
	logrus.Print(result[len("var url = '"):len(result) -1 ])
}

func TestDecode(t *testing.T)  {
	key = "233535F4D3E6F69637275667D25627574716E6769637D23737F6D287624433528325776423523685A744A76695A466652616E464235287144546E46784A7D636965665A4B4C47476A44563378715A5D35627574716E6769637D23737F6D2876223638343034303436313D337562796078756D23737F6D28762153393436423E614D6535437941445C4D34696D29756B6D2373756363616D23737F6D287626303336333632356730326361643139303261643931636432356534336562666D357624307D6E213035413033563835323526314532352935453235223935323525383532352935453235243245323529324532352535453235254245323529393532352735453235273235273235283D264459333034363135544335214235256D616E656C6966603235224335247E656D6863616474716D3E6F696479637F607379646D247E65647E6F636D25637E6F6073756276246661383166616034383939353831616933633435366633383539323661633665353664313831363D366622373631323431393D32746629323A626D39646F3333603431613931333433346531626260303934313839356369363233313460313033646165303636423525313436616666693035336839363832693663343638373232303239326932366130336461653036364235223938313831343642352370716B474553794F2D6F636E20736364657F6C63696C616E216471646E276E696A6965626D2E636E29323A626F2F2A33707474786"
	logrus.Print(decodeStr(htoStr(strReverse(key))))
}